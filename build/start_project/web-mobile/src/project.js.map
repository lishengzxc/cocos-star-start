{"version":3,"sources":["project.js"],"names":["require","e","t","n","r","s","o","u","a","i","f","Error","code","l","exports","call","length","Game","module","cc","_RFpush","Class","extends","Component","properties","starPrefab","default","type","Prefab","maxStarDuration","minStarDuration","ground","Node","player","scoreDisplay","Label","onLoad","this","groundY","y","height","spawnNewStar","score","newStar","instantiate","node","addChild","setPosition","getNewStarPosition","getComponent","game","randX","randY","random0To1","jumpHeight","maxX","width","randomMinus1To1","p","gainScore","string","toString","_RFpop","Player","jumpDuration","maxMoveSpeed","accel","jumpAudio","url","AudioClip","setJumpAction","jumpUp","moveBy","easing","easeCubicActionOut","jumpDown","easeCubicActionIn","callback","callFunc","playJumpSound","repeatForever","sequence","audioEngine","playEffect","setInputControl","self","eventManager","addListener","event","EventListener","KEYBOARD","onKeyPressed","keyCode","KEY","accLeft","accRight","d","onKeyReleased","jumpAction","runAction","xSpeed","update","dt","Math","abs","x","Star","pickRadius","getPlayerDistance","playerPos","getPosition","dist","pDistance","position","onPicked","destroy"],"mappings":"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","file":"project.js","sourcesContent":["require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({\"Game\":[function(require,module,exports){\ncc._RFpush(module, '44b142c4fdDX4efKjfzzzRK', 'Game');\n// scripts/Game.js\n\n'use strict';\n\ncc.Class({\n    'extends': cc.Component,\n\n    properties: {\n        // 这个属性引用了星星预制资源\n        starPrefab: {\n            'default': null,\n            type: cc.Prefab\n        },\n        // 星星产生后消失时间的随机范围\n        maxStarDuration: 0,\n        minStarDuration: 0,\n        // 地面节点，用于确定星星生成的高度\n        ground: {\n            'default': null,\n            type: cc.Node\n        },\n        // player 节点，用于获取主角弹跳的高度，和控制主角行动开关\n        player: {\n            'default': null,\n            type: cc.Node\n        },\n        scoreDisplay: {\n            'default': null,\n            type: cc.Label\n        }\n    },\n\n    onLoad: function onLoad() {\n        // 获取地平面的 y 轴坐标\n        this.groundY = this.ground.y + this.ground.height / 2;\n        // 生成一个新的星星\n        this.spawnNewStar();\n        this.score = 0;\n    },\n\n    spawnNewStar: function spawnNewStar() {\n        // 使用给定的模板在场景中生成一个新节点\n        var newStar = cc.instantiate(this.starPrefab);\n        // 将新增的节点添加到 Canvas 节点下面\n        this.node.addChild(newStar);\n        // 为星星设置一个随机位置\n        newStar.setPosition(this.getNewStarPosition());\n\n        newStar.getComponent('Star').game = this;\n    },\n\n    getNewStarPosition: function getNewStarPosition() {\n        var randX = 0;\n        // 根据地平面位置和主角跳跃高度，随机得到一个星星的 y 坐标\n        var randY = this.ground + cc.random0To1() * this.player.getComponent('Player').jumpHeight + 50;\n        // 根据屏幕宽度，随机得到一个星星 x 坐标\n        var maxX = this.node.width / 2;\n        randX = cc.randomMinus1To1() * maxX;\n        // 返回星星坐标\n        return cc.p(randX, randY);\n    },\n\n    gainScore: function gainScore() {\n        this.score += 1;\n        // 更新 scoreDisplay Label 的文字\n        this.scoreDisplay.string = 'Score: ' + this.score.toString();\n    }\n});\n\ncc._RFpop();\n},{}],\"Player\":[function(require,module,exports){\ncc._RFpush(module, '94165OAGO9B2JSd20CTaMn7', 'Player');\n// scripts/Player.js\n\n\"use strict\";\n\ncc.Class({\n    \"extends\": cc.Component,\n\n    properties: {\n        // 主角跳跃高度\n        jumpHeight: 0,\n        // 主角跳跃持续时间\n        jumpDuration: 0,\n        // 最大移动速度\n        maxMoveSpeed: 0,\n        // 加速度\n        accel: 0,\n\n        jumpAudio: {\n            \"default\": null,\n            url: cc.AudioClip\n        }\n    },\n\n    setJumpAction: function setJumpAction() {\n        var jumpUp = cc.moveBy(this.jumpDuration, cc.p(0, this.jumpHeight)).easing(cc.easeCubicActionOut());\n        // 下落\n        var jumpDown = cc.moveBy(this.jumpDuration, cc.p(0, -this.jumpHeight)).easing(cc.easeCubicActionIn());\n        // 添加一个回调函数，用于在动作结束时调用我们定义的其他方法\n        var callback = cc.callFunc(this.playJumpSound, this);\n        // 不断重复，而且每次完成落地动作后调用回调来播放声音\n        return cc.repeatForever(cc.sequence(jumpUp, jumpDown, callback));\n    },\n\n    playJumpSound: function playJumpSound() {\n        // 调用声音引擎播放声音\n        cc.audioEngine.playEffect(this.jumpAudio, false);\n    },\n\n    setInputControl: function setInputControl() {\n        var self = this;\n        // 添加键盘事件监听\n        cc.eventManager.addListener({\n            event: cc.EventListener.KEYBOARD,\n            // 有按键按下时，判断是否是我们指定的方向控制键，并设置向对应方向加速\n            onKeyPressed: function onKeyPressed(keyCode, event) {\n                switch (keyCode) {\n                    case cc.KEY.a:\n                        self.accLeft = true;\n                        self.accRight = false;\n                        break;\n                    case cc.KEY.d:\n                        self.accLeft = false;\n                        self.accRight = true;\n                        break;\n                }\n            },\n            // 松开按键时，停止向该方向的加速\n            onKeyReleased: function onKeyReleased(keyCode, event) {\n                switch (keyCode) {\n                    case cc.KEY.a:\n                        self.accLeft = false;\n                        break;\n                    case cc.KEY.d:\n                        self.accRight = false;\n                        break;\n                }\n            }\n        }, self.node);\n    },\n\n    // use this for initialization\n    onLoad: function onLoad() {\n        // 初始化跳跃动作\n        this.jumpAction = this.setJumpAction();\n        this.node.runAction(this.jumpAction);\n\n        // 加速度方向开关\n        this.accLeft = false;\n        this.accRight = false;\n        // 主角当前水平方向速度\n        this.xSpeed = 0;\n\n        // 初始化键盘输入监听\n        this.setInputControl();\n    },\n\n    // called every frame, uncomment this function to activate update callback\n    update: function update(dt) {\n        if (this.accLeft) {\n            this.xSpeed -= this.accel * dt;\n        } else if (this.accRight) {\n            this.xSpeed += this.accel * dt;\n        }\n        // 限制主角的速度不能超过最大值\n        if (Math.abs(this.xSpeed) > this.maxMoveSpeed) {\n            // if speed reach limit, use max speed with current direction\n            this.xSpeed = this.maxMoveSpeed * this.xSpeed / Math.abs(this.xSpeed);\n        }\n\n        // 根据当前速度更新主角的位置\n        this.node.x += this.xSpeed * dt;\n    }\n});\n\ncc._RFpop();\n},{}],\"Star\":[function(require,module,exports){\ncc._RFpush(module, '0baf4czshNFf4CW4TTc361h', 'Star');\n// scripts/Star.js\n\n\"use strict\";\n\ncc.Class({\n    \"extends\": cc.Component,\n\n    properties: {\n        // 星星和主角之间的距离小于这个数值时，就会完成收集\n        pickRadius: 0\n    },\n\n    // use this for initialization\n    onLoad: function onLoad() {},\n\n    getPlayerDistance: function getPlayerDistance() {\n        // 根据 player 节点位置判断距离\n        var playerPos = this.game.player.getPosition();\n        // 根据两点位置计算两点之间距离\n        var dist = cc.pDistance(this.node.position, playerPos);\n        return dist;\n    },\n\n    onPicked: function onPicked() {\n        // 当星星被收集时，调用 Game 脚本中的接口，生成一个新的星星\n        this.game.spawnNewStar();\n        // 调用 Game 脚本的得分方法\n        this.game.gainScore();\n        // 然后销毁当前星星节点\n        this.node.destroy();\n    },\n\n    // called every frame, uncomment this function to activate update callback\n    update: function update(dt) {\n        // 每帧判断和主角之间的距离是否小于收集距离\n        if (this.getPlayerDistance() < this.pickRadius) {\n            // 调用收集行为\n            this.onPicked();\n            return;\n        }\n    }\n});\n\ncc._RFpop();\n},{}]},{},[\"Star\",\"Game\",\"Player\"]);\n"],"sourceRoot":"/source/"}